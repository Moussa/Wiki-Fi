<!DOCTYPE html>
<html>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.2.2/bootstrap.min.js"></script>

<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='bootstrap.min.css') }}">
<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='bootstrap-responsive.min.css') }}">
<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='style.css') }}">

<script type="text/javascript">
$(document).ready(function() {

	$('button[type=submit]').click(function () {
		var username = $('input[name=username]').val();
		var wiki = $(".btn-group input[name=is_private]:checked").val();
		var data = {username: username, wiki: wiki};
	    $.ajax({
	        url: '/is_valid_user',
	        type: 'POST',
	        dataType: 'json',
	        data: data,
	        success: function(data) {
	        	if (data){
	        		$('button[type=submit]').removeClass('btn-primary btn-danger').addClass('btn-success').html('Loading stats...');
	        		$('#loader').css('visibility','visible');

	        		window.location = "/stats?username=" + username + "&wiki=" + wiki;
	        	}
	        	else {
	        		$('button[type=submit]').removeClass('btn-primary').addClass('btn-danger').html('Invalid username');
	        		setTimeout(function() {
	        			$('button[type=submit]').removeClass('btn-danger').addClass('btn-primary').html('Submit');
	        		}, 2000);
	        	}
	                 },
	        fail: function(data) {
	        	console.log('fail');
	                 }
	    });
	    return false;
	});
});
</script>

    <body>

        <div class="username-form">
		    <form class="form-search">

		    	<div class="btn-group" data-toggle="buttons-radio" >
				  <button type="button" class="btn" data-toggle="button">Portal Wiki
				    <input type="radio" name="is_private" value="portal" />
				  </button>
				  <button type="button" class="btn active" data-toggle="button">Official TF Wiki
				    <input type="radio" name="is_private" value="tf" checked="checked" />
				  </button>
				  <button type="button" class="btn" data-toggle="button">Dota2 Wiki
				    <input type="radio" name="is_private" value="dota2" />
				  </button>
				</div>

		        <div class="input-append">
		        	<img id="loader" src="{{ url_for('static', filename='loader.gif') }}">
		            <input type="text" name="username" id="username" class="input-large" placeholder="Username">
		            <button type="submit" class="btn btn-large btn-primary">Submit</button>
		        </div>
		    </form>
	    </div>

    </body>

</html>